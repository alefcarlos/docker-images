trigger:
  branches:
    include:
      - master
  paths:
    exclude:
      - README.md
    include:
      - aspnet/grpc/3-0.Dockerfile

pool:
  vmImage: "ubuntu-latest"

steps:
  - task: Docker@2
    condition: and(succeeded(), ne(variables['Build.Reason'], 'PullRequest'))
    displayName: "Docker Login Canister.io"
    inputs:
      containerRegistry: 'Docker Hub'
      command: 'login'

  - task: Docker@2
    inputs:
      containerRegistry: 'Docker Hub'
      repository: 'alefcarlos/aspnet-grpc'
      command: 'buildAndPush'
      Dockerfile: '$(Build.SourcesDirectory)/aspnet/grpc/3-0.Dockerfile'
      tags: '3.0'